# 14. Correlation and Data Visualization

> Use Python (Seaborn, Matplotlib) or Power BI to find and visualize the correlation between variables in a dataset.

---

## Python Implementation

### Import Libraries

```python
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.datasets import load_iris
```

---

## Step 1: Load Dataset

```python
# Example: Iris dataset
iris = load_iris(as_frame=True)
df = iris.frame  # pandas DataFrame

print(df.head())
print(df.info())
```

---

## Step 2: Compute Correlation Matrix

```python
# Calculate correlation matrix
corr_matrix = df.corr()

print("Correlation Matrix:")
print(corr_matrix)
```

---

## Step 3: Visualization

### 1. Heatmap

```python
plt.figure(figsize=(8, 6))
sns.heatmap(
    corr_matrix, 
    annot=True,           # Show correlation values
    cmap="coolwarm",      # Color scheme
    fmt=".2f",            # Format to 2 decimal places
    linewidths=0.5,
    square=True,
    cbar_kws={"shrink": 0.8}
)
plt.title("Correlation Heatmap of Iris Dataset")
plt.tight_layout()
plt.show()
```

### 2. Pairplot (Scatter Plot Matrix)

```python
# Scatter plot matrix to see relationships
sns.pairplot(df, diag_kind="kde", hue="target", palette="Set2")
plt.suptitle("Pairplot of Iris Dataset", y=1.02)
plt.show()
```

---

## Additional Visualizations

### 3. Scatter Plot with Regression Line

```python
plt.figure(figsize=(8, 6))
sns.regplot(
    x='sepal length (cm)', 
    y='petal length (cm)', 
    data=df,
    scatter_kws={'alpha':0.5},
    line_kws={'color':'red'}
)
plt.title("Sepal Length vs Petal Length (with Regression Line)")
plt.xlabel("Sepal Length (cm)")
plt.ylabel("Petal Length (cm)")
plt.grid(True, alpha=0.3)
plt.show()
```

### 4. Correlation Bar Plot

```python
# Show correlation of all features with a target feature
target_corr = corr_matrix['petal length (cm)'].sort_values(ascending=False)

plt.figure(figsize=(8, 5))
target_corr.plot(kind='barh', color='teal')
plt.title("Correlation with Petal Length")
plt.xlabel("Correlation Coefficient")
plt.grid(axis='x', alpha=0.3)
plt.tight_layout()
plt.show()
```

---

## Using a Custom Dataset

### Load Custom CSV

```python
# Load your own dataset
df = pd.read_csv('your_dataset.csv')

# Select only numeric columns for correlation
numeric_df = df.select_dtypes(include=['float64', 'int64'])

# Compute correlation
corr_matrix = numeric_df.corr()
```

### Visualize

```python
plt.figure(figsize=(10, 8))
sns.heatmap(
    corr_matrix, 
    annot=True, 
    cmap="viridis", 
    fmt=".2f", 
    linewidths=0.5
)
plt.title("Correlation Heatmap")
plt.tight_layout()
plt.show()
```

---

## Clustermap (Hierarchical Clustering)

```python
# Clustermap shows correlation with hierarchical clustering
sns.clustermap(
    corr_matrix, 
    annot=True, 
    cmap="RdBu_r", 
    fmt=".2f",
    figsize=(10, 8)
)
plt.title("Correlation Clustermap")
plt.show()
```

---

## Using Power BI

### Steps:

1. **Load Data**: Import your dataset into Power BI Desktop.
2. **Create Matrix Visual**: Drag and drop numeric columns to create a correlation table.
3. **Conditional Formatting**: Apply color scales to highlight strong correlations.
4. **Scatter Plots**: Create scatter charts with trend lines.
5. **Custom Visuals**: Download "Correlation Plot" from AppSource.

---

## Summary

| **Visualization** | **Purpose** |
|-------------------|-------------|
| **Heatmap** | Show correlation matrix with color coding |
| **Pairplot** | Show relationships between all variable pairs |
| **Scatter + Regression** | Linear relationship between two variables |
| **Clustermap** | Group correlated variables using clustering |

### Key Insights:
- **Positive correlation** (close to +1): Variables move together
- **Negative correlation** (close to -1): Variables move in opposite directions
- **No correlation** (close to 0): No linear relationship
