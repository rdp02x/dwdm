# OLAP Operations with SQL

## 1. ROLL-UP

**Total rental amount rolled up by Genre → Year**

```sql
SELECT 
    Genre, 
    Year, 
    SUM(RentalAmount) AS TotalRental
FROM FactRental F
JOIN DimMovie M ON F.MovieID = M.MovieID
JOIN DimDate D ON F.DateID = D.DateID
GROUP BY ROLLUP (Genre, Year);
```

## 2. DRILL-DOWN

**Drill down from Genre to specific Movies in 2025**

```sql
SELECT 
    Genre, 
    Title, 
    SUM(RentalAmount) AS TotalRental
FROM FactRental F
JOIN DimMovie M ON F.MovieID = M.MovieID
JOIN DimDate D ON F.DateID = D.DateID
WHERE D.Year = 2025
GROUP BY Genre, Title;
```

## 3. SLICE

**Slice the data for rentals made in 'Action' genre only**

```sql
SELECT 
    Title, 
    SUM(RentalAmount) AS TotalRental
FROM FactRental F
JOIN DimMovie M ON F.MovieID = M.MovieID
WHERE Genre = 'Action'
GROUP BY Title;
```

## 4. DICE

**Get rental amounts for 'Comedy' or 'Action' genres AND customers in the age group '18-25' during the year 2025**

```sql
SELECT 
    Genre, 
    AgeGroup, 
    Year,
    SUM(RentalAmount) AS TotalRental
FROM FactRental F
JOIN DimMovie M ON F.MovieID = M.MovieID
JOIN DimCustomer C ON F.CustomerID = C.CustomerID
JOIN DimDate D ON F.DateID = D.DateID
WHERE Genre IN ('Comedy', 'Action')
  AND AgeGroup = '18-25'
  AND Year = 2025
GROUP BY Genre, AgeGroup, Year;
```

## 5. PIVOT

```

4.DICE



Get rental amounts for ‘Comedy’ or ‘Action’ genres AND customers in the age group '18-
25' during the year 2025

SELECT 

    Genre, 

    AgeGroup, 

    Year,

    SUM(RentalAmount) AS TotalRentalFROM FactRental FJOIN DimMovie M ON 
F.MovieID = M.MovieIDJOIN DimCustomer C ON F.CustomerID = C.CustomerIDJOIN 
DimDate D ON F.DateID = D.DateIDWHERE Genre IN ('Comedy', 'Action')

  AND AgeGroup = '18-25'

  AND Year = 2025GROUP BY Genre, AgeGroup, Year;

## 5. PIVOT

**Pivot table: Total rental amount per Genre per Year**

### SQL Server example using PIVOT operator

```sql
SELECT *
FROM (
    SELECT 
        Genre, 
        Year, 
        RentalAmount
    FROM FactRental F
    JOIN DimMovie M ON F.MovieID = M.MovieID
    JOIN DimDate D ON F.DateID = D.DateID
) AS SourceTable
PIVOT (
    SUM(RentalAmount)
    FOR Year IN ([2023], [2024], [2025])
) AS PivotTable;
```

### For PostgreSQL or Oracle, use CASE WHEN style pivot:

```sql
SELECT 
    Genre,
    SUM(CASE WHEN Year = 2023 THEN RentalAmount ELSE 0 END) AS "2023",
    SUM(CASE WHEN Year = 2024 THEN RentalAmount ELSE 0 END) AS "2024",
    SUM(CASE WHEN Year = 2025 THEN RentalAmount ELSE 0 END) AS "2025"
FROM FactRental F
JOIN DimMovie M ON F.MovieID = M.MovieID
JOIN DimDate D ON F.DateID = D.DateID
GROUP BY Genre;
```