# 9. Association Rule Mining

> Use the Apriori algorithm in WEKA or Python (mlxtend) to find interesting rules in a supermarket transaction dataset.

---

## 1. Using Apriori in WEKA

WEKA has Apriori built-in under Associate tab.

### Steps:

#### Load Dataset

- Open WEKA → Explorer → Preprocess tab.
- Load a dataset in ARFF or CSV format (e.g., `supermarket.arff`).
- Transactions should be represented in a basket format (e.g., each row = one customer's purchases).

#### Example dataset snippet (ARFF):

```
@relation supermarket

@attribute milk {t,f}
@attribute bread {t,f}
@attribute butter {t,f}
@attribute cheese {t,f}

@data
t,t,f,f
t,t,t,f
f,t,t,t
t,f,t,f
```

#### Run Apriori

- Go to **Associate** tab.
- Choose **Apriori** as the algorithm.
- Set parameters:
  - `minMetric` (confidence threshold, e.g., 0.8)
  - `lowerBoundMinSupport` (support threshold, e.g., 0.1).

#### View Rules

WEKA outputs association rules like:

```
butter=t  ==> bread=t  conf:(0.9)
milk=t    ==> bread=t  conf:(0.85)
```

---

## 2. Using Apriori in Python (mlxtend)

### Install mlxtend

```bash
pip install mlxtend
```

### Load Transaction Data

```python
import pandas as pd
from mlxtend.frequent_patterns import apriori, association_rules

# Sample transaction data
data = {
    'milk': [1, 1, 0, 1],
    'bread': [1, 1, 1, 0],
    'butter': [0, 1, 1, 1],
    'cheese': [0, 0, 1, 0]
}

df = pd.DataFrame(data)
print(df)
```

### Apply Apriori Algorithm

```python
# Find frequent itemsets with min support = 0.5
frequent_itemsets = apriori(df, min_support=0.5, use_colnames=True)
print("\nFrequent Itemsets:")
print(frequent_itemsets)
```

### Generate Association Rules

```python
# Generate rules with min confidence = 0.7
rules = association_rules(frequent_itemsets, metric="confidence", min_threshold=0.7)
print("\nAssociation Rules:")
print(rules[['antecedents', 'consequents', 'support', 'confidence', 'lift']])
```

### Interpret Results

```python
# Filter strong rules (high lift)
strong_rules = rules[rules['lift'] > 1.0]
print("\nStrong Rules (lift > 1):")
print(strong_rules[['antecedents', 'consequents', 'confidence', 'lift']])
```

---

## Example Output

```
Association Rules:
    antecedents consequents  support  confidence  lift
0       (butter)     (bread)     0.75        0.90  1.2
1         (milk)     (bread)     0.50        0.85  1.1
```

**Interpretation:**
- If a customer buys butter, there's a 90% chance they'll buy bread.
- The lift of 1.2 indicates this association is stronger than random.

---

## Summary

| **Tool** | **Advantages** | **Use Case** |
|----------|---------------|-------------|
| **WEKA** | GUI, no coding | Quick exploration |
| **Python (mlxtend)** | Flexible, customizable | Production, large datasets |
